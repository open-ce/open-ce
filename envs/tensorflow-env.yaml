builder_version: ">=10.0.1"

imported_envs:
  - bazel-env.yaml
  - tensorflow-s390x-extra-deps-env.yaml
  - common-p10-deps.yaml      #[ppc_arch == "p10"]
  - common-deps.yaml
  - jax-env.yaml

packages:
{% if build_type == 'cuda' %}
  - feedstock : nccl
  - feedstock : cudnn
  - feedstock : cudatoolkit    #[cudatoolkit == "11.2" or cudatoolkit == "11.8"]
{% endif %}
  - feedstock : https://github.com/AnacondaRecipes/absl-py-feedstock
    git_tag : be1d3b7f51b3f9896c92709885faa1819f4bd6c9
    patches :
      - feedstock-patches/absl-py/0001-Updated-absl-py-to-1.0.0.patch
  - feedstock : https://github.com/conda-forge/tokenize-rt-feedstock
    git_tag : 21f5be31c04b0fa67e5f96aa94621abba19e52c3
  - feedstock : https://github.com/conda-forge/grpcio-feedstock
    git_tag : a99441fbf15d9bafd4370ea1c88c3c54311efdff
    patches :
      - feedstock-patches/grpcio/0001-Update-to-1.53.2-to-fix-CVE.patch            #[not s390x]
      - feedstock-patches/grpcio/0001-opence-changes-for-s390x.patch     #[s390x]
  - feedstock : keras
    git_tag : r2.13.1
  - feedstock : https://github.com/Aman-Surkar/tensorflow-feedstock
    git_tag : r2.13.1
  - feedstock : dm-tree
  - feedstock : https://github.com/Aman-Surkar/tensorflow-probability-feedstock 
    git_tag : r0.21.0
  - feedstock : tensorflow-estimator
    git_tag : r2.13.0
  - feedstock : tensorboard-data-server
  - feedstock : tensorboard
    git_tag : r2.13.0  
  - feedstock : tensorflow-hub
  - feedstock : tensorflow-metadata
  - feedstock : etils
  - feedstock : array-record
  - feedstock : tensorflow-datasets
  - feedstock : tensorflow-text
    git_tag : r2.13.0
  - feedstock : tensorflow-model-optimization
  - feedstock : tensorflow-addons
    git_tag : r0.21.0
  - feedstock : tensorflow-io-gcs-filesystem  # [not s390x]
    git_tag : r0.33.0  # [not s390x]

git_tag_for_env: open-ce-v1.9.4
