builder_version: ">=10.0.1"

imported_envs:
{% if not s390x %}
  - tensorflow-env.yaml
{% endif %}
  - common-deps.yaml

packages:
  - feedstock : onnx
{% if not s390x %}
  - feedstock : safeint
  - feedstock : gtest
  - feedstock : libdate
  - feedstock : optional-lite
  - feedstock : boost_mp11
  - feedstock : https://github.com/conda-forge/fire-feedstock
    git_tag : a691d408ec35d71fdf9aecbed6efb408affb2b80
  - feedstock : https://github.com/conda-forge/cmake-feedstock
    git_tag : 0a6e1b3981a240d0d80829fbfc6080aaf6d2a9f6
    patches :
      - feedstock-patches/cmake/0001-use-GCC-8-for-cuda-11.2-builds.patch
      - feedstock-patches/cmake/0001-P10-changes.patch         #[ppc_arch == 'p10']
  {% if build_type == 'cuda' %}
  - feedstock : cudatoolkit    #[cudatoolkit == "11.2" or cudatoolkit == "11.8"]
  - feedstock : cudnn
  - feedstock : nccl
  {% endif %}
  - feedstock : onnxruntime
  - feedstock : onnxconverter-common
  - feedstock : skl2onnx
  - feedstock : onnxmltools
  - feedstock : tf2onnx
{% endif %}

git_tag_for_env: open-ce-v1.9.0
