From 21f6c48ebe29b2d3bb7cf002afc307143c02ed3b Mon Sep 17 00:00:00 2001
From: Deepali Chourasia <deepch23@in.ibm.com>
Date: Thu, 12 May 2022 06:31:30 +0000
Subject: [PATCH] remove dependency on openmp_mutex and use GCC11 for p10

---
 recipe/meta.yaml | 9 ++++-----
 1 file changed, 4 insertions(+), 5 deletions(-)

diff --git a/recipe/meta.yaml b/recipe/meta.yaml
index 3ea7189..79f4920 100644
--- a/recipe/meta.yaml
+++ b/recipe/meta.yaml
@@ -14,6 +14,8 @@ source:
 build:
   number: 0
   skip: true  # [win and vc<14]
+  script_env:                  # [ppc_arch == "p10"]
+    - GCC_11_HOME              # [ppc_arch == "p10"]
 
 outputs:
   - name: llvm-openmp
@@ -23,15 +25,12 @@ outputs:
       ignore_run_exports:
         - libgcc-ng
         - libstdcxx-ng
-        - _openmp_mutex
       run_exports:
         strong:
           - {{ pin_subpackage("llvm-openmp", max_pin=None) }}
-          - _openmp_mutex >={{ openmp_ver }}  # [linux]
-          - _openmp_mutex * *_llvm            # [linux]
     requirements:
       build:
-        - {{ compiler('cxx') }}  # [unix]
+        - {{ compiler('cxx') }}         # [ppc_arch != "p10"]
         - vs2017_{{ target_platform }}  # [win]
         - cmake
         - make  # [unix]
@@ -46,7 +45,7 @@ outputs:
     test:
       requires:
         - clangxx
-        - {{ compiler('cxx') }}  # [unix]
+        - {{ compiler('cxx') }}          # [ ppc_arch != "p10"]
         - vs2017_{{ target_platform }}  # [win]
       commands:
         - if not exist %LIBRARY_BIN%\\libomp.dll exit 1   # [win]
-- 
2.34.1

