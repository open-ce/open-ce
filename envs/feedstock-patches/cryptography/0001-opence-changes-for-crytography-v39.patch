From d68490e33d53d0951cf11b2262ab77d636a5996d Mon Sep 17 00:00:00 2001
From: Deepali Chourasia <deepch23@in.ibm.com>
Date: Wed, 13 Sep 2023 09:47:33 +0000
Subject: [PATCH] opence changes for cryptography

---
 recipe/meta.yaml | 18 ++++++++++--------
 1 file changed, 10 insertions(+), 8 deletions(-)

diff --git a/recipe/meta.yaml b/recipe/meta.yaml
index 1b76b0f..402024a 100644
--- a/recipe/meta.yaml
+++ b/recipe/meta.yaml
@@ -11,24 +11,25 @@ source:
 build:
   number: 0
   skip: true  # [py<37 or win32]
-  script: {{ PYTHON }} -m pip install . -vv --no-deps
+  string: opence_py{{ python | replace(".", "") }}_h{{ PKG_HASH }}_{{ PKG_BUILDNUM }}
+  script: CFLAGS="-I$CONDA_PREFIX/include" LDFLAGS="-L$CONDA_PREFIX/lib"  {{ PYTHON }} -m pip install . -vv --no-deps
   missing_dso_whitelist:  # [s390x]
     - $RPATH/ld64.so.1    # [s390x]
 requirements:
   build:
     - {{ compiler('rust') }}
-    - vs2017_{{ target_platform }}    # [win]
+    - {{ compiler('c') }}
   host:
-    - python
+    - python {{ python }}
     - cffi >=1.12
-    - pip
-    - setuptools >=40.6.0,!=60.9.0
-    - setuptools-rust >=0.11.4
+    - pip  {{ pip }}
+    - setuptools {{ setuptools }}
+    - setuptools-rust {{ setuptools_rust }}
     - wheel
   run:
-    - python
+    - python {{ python }}
     - cffi >=1.12
-    - openssl
+    - openssl 1.1.1zz
     - libgcc-ng     # [linux]; needed by `_rust.abi3.so`
 
 test:
@@ -37,6 +38,7 @@ test:
     - hypothesis >=1.11.4,!=3.79.2
     - iso8601
     - pip
+    - py
     - pretend
     - pytest >=6.2.0
     - pytest-subtests
-- 
2.40.1

