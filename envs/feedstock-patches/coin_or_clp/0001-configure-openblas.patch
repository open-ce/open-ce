From 68f5c6863a93948327e638168741a4919ee1a997 Mon Sep 17 00:00:00 2001
From: ArchanaShinde1 <archana.shinde2504@gmail.com>
Date: Thu, 15 Jun 2023 07:20:21 +0000
Subject: [PATCH] configure openblas

---
 config/conda_build_config.yaml | 6 ++++++
 recipe/build.sh                | 6 +++---
 recipe/meta.yaml               | 9 ++++-----
 3 files changed, 13 insertions(+), 8 deletions(-)
 create mode 100644 config/conda_build_config.yaml

diff --git a/config/conda_build_config.yaml b/config/conda_build_config.yaml
new file mode 100644
index 0000000..c823874
--- /dev/null
+++ b/config/conda_build_config.yaml
@@ -0,0 +1,6 @@
+c_compiler_version:
+  - 11.*          # [cudatoolkit == "11.2"]
+cxx_compiler_version:
+  - 11.*          # [cudatoolkit == "11.2"]
+fortran_compiler_version:
+  - 11.*          # [cudatoolkit == "11.2"]
diff --git a/recipe/build.sh b/recipe/build.sh
index b44859c..8b3cc80 100644
--- a/recipe/build.sh
+++ b/recipe/build.sh
@@ -19,8 +19,8 @@ fi
 # value at run-time to get the expected amount of parallelism.
 export OPENBLAS_NUM_THREADS=1
 
-WITH_BLAS_LIB="-L${PREFIX}/lib -lblas"
-WITH_LAPACK_LIB="-L${PREFIX}/lib -llapack"
+WITH_BLAS_LIB="-L${PREFIX}/lib -lopenblas"
+WITH_LAPACK_LIB="-L${PREFIX}/lib -lopenblas"
 
 ./configure \
     --prefix="${PREFIX}" \
@@ -30,4 +30,4 @@ WITH_LAPACK_LIB="-L${PREFIX}/lib -llapack"
     --enable-gnu-packages
 
 make -j "${CPU_COUNT}"
-make install
\ No newline at end of file
+make install
diff --git a/recipe/meta.yaml b/recipe/meta.yaml
index d22b864..a0cc88a 100644
--- a/recipe/meta.yaml
+++ b/recipe/meta.yaml
@@ -24,20 +24,19 @@ requirements:
     - {{ compiler('c') }}
     - {{ compiler('cxx') }}
     - {{ compiler('fortran') }}
-    - pkg-config
+    - pkg-config {{ pkgconfig }}
     - make  # [unix]
   host:
     - coin-or-utils
     - coin-or-osi
-    - libblas
-    - libcblas
-    - liblapack
+    - openblas {{ openblas }}
     - readline  # [unix]
-    - zlib
+    - zlib {{ zlib }}
     - bzip2
     - ncurses
   run:
     - ncurses
+    - openblas {{ openblas }}
   run_constrained:
     - coincbc * *_metapackage
 
-- 
2.34.1

