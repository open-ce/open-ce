From 1b0285d50ecdc176d076b5b1598be5e0c701ccd8 Mon Sep 17 00:00:00 2001
From: Nishidha Panpaliya <npanpa23@in.ibm.com>
Date: Tue, 7 Sep 2021 06:29:52 -0400
Subject: [PATCH] Some opence changes

---
 config/conda_build_config.yaml | 4 ++++
 recipe/build.sh                | 2 +-
 recipe/meta.yaml               | 6 +++---
 3 files changed, 8 insertions(+), 4 deletions(-)
 create mode 100644 config/conda_build_config.yaml

diff --git a/config/conda_build_config.yaml b/config/conda_build_config.yaml
new file mode 100644
index 0000000..d9c5e20
--- /dev/null
+++ b/config/conda_build_config.yaml
@@ -0,0 +1,4 @@
+c_compiler_version:
+  - 8
+cxx_compiler_version:
+  - 8
diff --git a/recipe/build.sh b/recipe/build.sh
index cc88e64..aa719f1 100644
--- a/recipe/build.sh
+++ b/recipe/build.sh
@@ -3,7 +3,7 @@ export UWSGI_INCLUDES="${PREFIX}/include,${PREFIX}/include/openssl"
 export LDFLAGS="-L${PREFIX}/lib ${LDFLAGS}"
 
 if [[ $(uname) == Linux ]]; then
-  export LDFLAGS="${LDFLAGS} -Wl,--no-as-needed"
+  export LDFLAGS="${LDFLAGS} -fno-lto -Wl,--no-as-needed"
 fi
 
 UWSGI_EMBED_PLUGINS=stats_pusher_statsd ${PYTHON} -m pip install . --no-deps -vv
diff --git a/recipe/meta.yaml b/recipe/meta.yaml
index cf36a13..835b173 100644
--- a/recipe/meta.yaml
+++ b/recipe/meta.yaml
@@ -24,11 +24,11 @@ requirements:
     - libpython-static  # [py>=38]
     - libxml2  # [not win]
     - openssl
-    - pcre
+    - pcre 8.44
     - pip
-    - python
+    - python {{ python }}
     - yaml
-    - zlib
+    - zlib {{zlib }}
   run:
     - jansson
     - python
-- 
2.32.0
