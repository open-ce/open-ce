builder_version: ">=4.0.0"

imported_envs:
  - bazel-env.yaml

conda_build_configs:
  - tensorflow_serving_conda_build_config.yaml

packages:
{% if build_type == 'cuda' %}
  - feedstock : cudatoolkit    #[cudatoolkit == "11.2"]
  - feedstock: libc_wrappers     #[x86_64 and (cudatoolkit == '11.0' or cudatoolkit == '11.2' or (py_ver < 3.8 and cudatoolkit == "10.2" ))]
  - feedstock: nccl
  - feedstock: cudnn
{% endif %}
  - feedstock: libevent
  - feedstock: tensorflow-serving

{% set py_ver = python | float %}
{% if py_ver >= 3.8 %}
  - feedstock: protobuf   #[ppc64le]
{% endif %}

git_tag_for_env: open-ce-v2.0.0
